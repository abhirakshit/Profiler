define("config/app/consts",[],function(){Application.module("Consts",function(e,t){t.STUDENT_ROLE="student",t.COUNSELOR_ROLE="counselor",t.ADMIN_ROLE="admin",t.SUPER_ADMIN_ROLE="superAdmin",t.START="start",t.SHOW="show",t.CLOSE="close",t.LOGOUT="logout",t.CHILDVIEW="childView",t.BEFORE_START="before:start",t.WHEN_FETCHED="when:fetched",t.SHOW_LOADING="show:loading",t.STREAM_LINK_SELECT="stream:link:select",t.STREAM_SELECT="stream:select",t.STREAM_CREATE="stream:create",t.STREAM_SHOW="stream:show",t.STREAM_GET="stream:get",t.STREAMS_GET="streams:get",t.DEGREES_BACHELORS_GET="degrees:bachelors:get",t.DEGREES_MASTERS_GET="degrees:masters:get",t.DEGREES_DOCTORATE_GET="degrees:doctorate:get",t.DEGREES_GET="degrees:get",t.DEGREE_GET="degree:get",t.SCHOOLS_GET="schools:get",t.SCHOOL_GET="school:get",t.MAJORS_GET="majors:get",t.MAJOR_GET="major:get",t.MAJOR_SHOW="major:show",t.OCCUPATIONS_GET="occupations:get",t.OCCUPATION_GET="occupation:get",t.COLLEGES_GET="colleges:get",t.COLLEGE_GET="college:get",t.SPECIALIZATIONS_GET="specializations:get",t.SPECIALIZATION_GET="specialization:get",t.COUNSELORS_GET="counselors:get",t.COUNSELOR_GET="counselor:get",t.SEARCH_SHOW="search:show",t.CAREER_SHOW="career:show",t.QUERIES_SHOW="queries:show",t.PROFILE_SHOW="profile:show",t.SETTINGS_SHOW="settings:show",t.FORUM_SHOW="forum:show",t.STREAM_NAV_SHOW="stream:nav:show",t.CAREER_NAV_SHOW="career:nav:show",t.CAREER_CONTENT_SHOW="career:content:show",t.SHOW_PROFILE="showProfile",t.SHOW_ADMIN="showAdmin",t.SHOW_MODULE="showModule",t.SET_SIDEBAR="setSidebar",t.CONTROLLER_ID="controller",t.USER_URL="/user",t.GET_LOGGED_USER="getLoggedUser",t.GET_USER="get:user",t.GET_PASSWORD="get:password",t.GET_ROLE="getRole",t.IS_USER_ADMIN="isUserAdmin",t.IS_STUDENT="isStudent",t.IS_COUNSELOR="isCounselor"})}),define("config/app/utils",[],function(){Application.module("Utils",function(e,t,n,r,i,s){String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)}})}),define("modules/entities/base/_utilities",["config/app/consts"],function(){Application.module("Entities",function(e,t,n,r,i,s){t.commands.setHandler(t.WHEN_FETCHED,function(e,t){var n=s.chain([e]).flatten().pluck("_fetch").value();return i.when.apply(i,n).done(function(){return t()})})})}),define("modules/entities/base/models",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.Model=n.Model.extend()})}),define("modules/entities/base/collections",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.Collection=n.Collection.extend({getIdToTitleArrayMap:function(){return this.getIdToTextMap("title")},getValueToTitleArrayMap:function(){return s.map(this.models,function(e){return{value:e.get("id"),text:e.get("title")}})},getIdToTextMap:function(e){return s.map(this.models,function(t){return{id:t.get("id"),text:t.get(e)}})}})})}),define("modules/entities/user",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.userUrl="/user",e.allCounselorsUrl="/users/counselors",e.loggedUserId=window.userId.replace(/&quot;/g,""),e.User=e.Model.extend({urlRoot:e.userUrl,validation:{firstName:{required:!0},email:{required:!0,pattern:"email"},password:{required:!0},confirmPassword:{equalTo:"password"}}}),e.Password=e.Model.extend({validation:{password:{required:!0},confirmPassword:{equalTo:"password"}}}),e.UsersCollection=e.Collection.extend({model:e.User});var o={getUser:function(t){if(!t)return new e.User;var n=new e.User;return n.id=t,n.fetch(),n},getAllCounselors:function(){return e.allCounselors||(e.allCounselors=new e.UsersCollection,e.allCounselors.url=e.allCounselorsUrl,e.allCounselors.fetch()),e.allCounselors},getPassword:function(){return new e.Password},getLoggedUser:function(){return e.loggedUser||(e.loggedUser=new e.User({id:e.loggedUserId}),e.loggedUser.urlRoot=t.USER_URL,e.loggedUser.fetch({async:!1})),e.loggedUser},isAdmin:function(){var e=this.getRole();return e==t.ADMIN_ROLE||e==t.SUPER_ADMIN_ROLE},isStudent:function(){var e=this.getRole();return e==t.STUDENT_ROLE},isCounselor:function(){var e=this.getRole();return e==t.COUNSELOR_ROLE},getRole:function(){return this.getLoggedUser().attributes.roleType},logout:function(){i.ajax({url:t.LOGOUT,success:function(){console.log("Logged Out..."),window.location.reload()}})}};t.reqres.setHandler(t.GET_LOGGED_USER,function(){return o.getLoggedUser()}),t.reqres.setHandler(t.GET_USER,function(e){return o.getUser(e)}),t.reqres.setHandler(t.GET_PASSWORD,function(){return o.getPassword()}),t.reqres.setHandler(t.IS_USER_ADMIN,function(){return o.isAdmin()}),t.reqres.setHandler(t.GET_ROLE,function(){return o.getRole()}),t.reqres.setHandler(t.IS_STUDENT,function(){return o.isStudent()}),t.reqres.setHandler(t.IS_COUNSELOR,function(){return o.isCounselor()}),t.reqres.setHandler(t.COUNSELORS_GET,function(){return o.getAllCounselors()}),t.reqres.setHandler(t.LOGOUT,function(){return o.logout()})})}),define("modules/views/_view",[],function(){Application.module("Views",function(e,t,n,r,i,s){s.extend(r.View.prototype,{templateHelpers:function(){}})})}),define("modules/views/collectionview",[],function(){Application.module("Views",function(e,t,n,r,i,s){e.CollectionView=r.CollectionView.extend({itemViewEventPrefix:"childView"})})}),define("modules/views/compositeview",[],function(){Application.module("Views",function(e,t,n,r,i,s){e.CompositeView=r.CompositeView.extend({itemViewEventPrefix:"childView"})})}),define("modules/views/itemview",[],function(){Application.module("Views",function(e,t,n,r,i,s){e.ItemView=r.ItemView.extend()})}),define("modules/views/layout",[],function(){Application.module("Views",function(e,t,n,r,i,s){e.Layout=r.Layout.extend()})}),define("modules/controllers/base_controller",[],function(){Application.module("Controllers",function(e,t,n,r){e.Base=r.Controller.extend({constructor:function(n){n||(n={}),this.region=n.region||t.request(t.DEFAULT_REGION),this._instance_ID=_.uniqueId(t.CONTROLLER_ID),t.execute(t.REGISTER_INSTANCE,this,this._instance_ID),e.Base.__super__.constructor.call(this,n)},close:function(){t.execute(t.UNREGISTER_INSTANCE,this,this._instance_ID),e.Base.__super__.close.apply(this)},show:function(e,t){t||(t={}),_.defaults(t,{loading:!1,region:this.region}),this.setMainView(e),this.manageView(e,t)},setMainView:function(e){if(this.mainView)return;this.mainView=e,this.listenTo(e,t.CLOSE,this.close)},manageView:function(e,n){n.loading?t.execute(t.SHOW_LOADING,e,n):n.region.show(e)}})})}),define("config/app/config_app",[],function(){Application.module("Config",function(e,t,n,r,i,s){e.setUpXEditableConfig=function(){i.fn.editable.defaults.mode="inline",i.fn.editable.defaults.ajaxOptions={type:"PATCH",dataType:"json"}}})}),define("modules/main/main_app",["config/app/consts","config/app/utils","modules/entities/base/_utilities","modules/entities/base/models","modules/entities/base/collections","modules/entities/user","modules/views/_view","modules/views/collectionview","modules/views/compositeview","modules/views/itemview","modules/views/layout","modules/controllers/base_controller","config/app/config_app"],function(){Application.module("Main",function(e,t,n,r){console.log("Load Main Dependencies"),t.ForumUrl="http://counsela.org/",t.Config.setUpXEditableConfig(),t.request(t.IS_USER_ADMIN)&&(t.USER_IS_ADMIN=!0),t.commands.setHandler(t.MODULES_LOADED,function(e){t.startHistory(),t.getCurrentRoute()||t.navigate(t.rootRoute,{trigger:!0})}),t.commands.setHandler(t.SHOW_MODULE,function(e){if(t.FORUM_SHOW===e){window.open(t.ForumUrl,"_blank");return}t.execute(t.SET_SIDEBAR,e),t.execute(e)})})}),define("modules/header/show/show_setup",[],function(){Application.module("Header.Show",function(e,t,n,r,i,s){this.prefix="Header.Show",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/header/show/show_view",["modules/header/show/show_setup"],function(){Application.module("Header.Show",function(e,t,n,r,i,s){e.views.Layout=t.Views.Layout.extend({template:"header/show/show_layout",className:"navbar-inner",regions:{appLabelRegion:"#app-label",navTabsRegion:"#header-nav-tabs",userDropDownRegion:"#user-dropdown"}});var o='<%=args.appLabel%><span class="beta">beta</span>';e.views.AppLabel=t.Views.ItemView.extend({tagName:"a",className:"brand",id:"appLabel",template:function(e){return s.template(o,{appLabel:e.appLabel},{variable:"args"})},events:{"click #appLabel":"showAppHome"},showAppHome:function(e){e.preventDefault(),console.log("Show App home")}});var u='<a href="<%=args.optionUrl%>"><i class="<%=args.iconClass%>"></i>&nbsp<%=args.optionText%></a>';e.views.UserDropDownOption=r.ItemView.extend({tagName:"li",initialize:function(){this.$el.prop("id",this.model.get("optionId"))},template:function(e){return s.template(u,{optionUrl:e.optionUrl,optionText:e.optionText,iconClass:e.iconClass},{variable:"args"})}}),e.views.UserDropDownCollection=r.CompositeView.extend({template:"header/show/userDropDownBtn",className:"btn-group pull-right",itemView:e.views.UserDropDownOption,itemViewContainer:"#user-actions",onRender:function(){this.$el.find("#logout").before('<li class="divider"></li>')},events:{"click #profile":t.SHOW_PROFILE,"click #admin":t.SHOW_ADMIN,"click #logout":t.LOGOUT},showProfile:function(e){e.preventDefault(),t.request(t.SHOW_PROFILE)},showAdmin:function(){event.preventDefault(),t.request(t.SHOW_ADMIN)},logout:function(){event.preventDefault(),t.request(t.LOGOUT)}})})}),define("modules/header/show/show_controller",["modules/header/show/show_view","modules/entities/user"],function(){Application.module("Header.Show",function(e,t,n,r,i,s){e.Controller=t.Controllers.Base.extend({initialize:function(){this.layout=this.getLayout(),this.listenTo(this.layout,t.SHOW,function(){this.showAppName(),this.showUserDropDown()}),this.show(this.layout)},getLayout:function(){return new e.views.Layout},showAppName:function(){var n=new e.views.AppLabel({model:new t.Entities.Model({appLabel:"Counsela"})});this.show(n,{region:this.layout.appLabelRegion})},showUserDropDown:function(){var n=t.request(t.GET_LOGGED_USER),r=new e.views.UserDropDownCollection({collection:this.getDropDownOptions(),model:n});this.show(r,{region:this.layout.userDropDownRegion})},getDropDownOptions:function(){return t.USER_IS_ADMIN?this.getAdminDropDownOptions():this.getUserDropDownOptions()},getUserDropDownOptions:function(){return new t.Entities.Collection([new t.Entities.Model({optionId:"profile",optionUrl:"#user/profile",optionText:"Profile",iconClass:"icon-user"}),new t.Entities.Model({optionId:"logout",optionUrl:t.LOGOUT,optionText:"Logout",iconClass:"icon-off"})])},getAdminDropDownOptions:function(){return new t.Entities.Collection([new t.Entities.Model({optionId:"profile",optionUrl:"#user/profile",optionText:"Profile",iconClass:"icon-user"}),new t.Entities.Model({optionId:"admin",optionUrl:"#admin",optionText:"Admin",iconClass:""}),new t.Entities.Model({optionId:"logout",optionUrl:t.LOGOUT,optionText:"Logout",iconClass:"icon-off"})])}})})}),define("modules/header/header_app",["modules/header/show/show_controller"],function(){Application.module("Header",function(e,t,n,r,i,s){var o={show:function(){new e.Show.Controller({region:t.headerRegion})}};e.setup=function(){o.show()},e.on(t.START,function(){console.log("Header start..."),r.TemplateLoader.loadModuleTemplates(e.Show,e.setup)})})}),define("modules/footer/show/show_setup",[],function(){Application.module("Footer.Show",function(e,t,n,r,i,s){this.prefix="Footer.Show",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/footer/show/show_view",["modules/footer/show/show_setup"],function(){Application.module("Footer.Show",function(e,t,n,r,i,s){e.views.Layout=t.Views.Layout.extend({template:"footer/show/show_layout"})})}),define("modules/footer/show/show_controller",["modules/footer/show/show_view"],function(){Application.module("Footer.Show",function(e,t,n,r,i,s){e.Controller=t.Controllers.Base.extend({initialize:function(){this.layout=this.getLayout(),this.show(this.layout)},getLayout:function(){return new e.views.Layout}})})}),define("modules/footer/footer_app",["modules/footer/show/show_controller"],function(){Application.module("Footer",function(e,t,n,r,i,s){var o={show:function(){new e.Show.Controller({region:t.footerRegion})}};e.setup=function(){o.show()},e.on(t.START,function(){console.log("Footer start..."),r.TemplateLoader.loadModuleTemplates(e.Show,e.setup)})})}),define("modules/sidebar/list/list_setup",[],function(){Application.module("Sidebar.List",function(e,t,n,r,i,s){this.prefix="Sidebar.List",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/sidebar/list/list_view",["modules/sidebar/list/list_setup"],function(){Application.module("Sidebar.List",function(e,t,n,r,i,s){e.views.SideBarTab=t.Views.ItemView.extend({template:"sidebar/list/listTab",tagName:"li",initialize:function(){this.$el.prop("id",this.model.get("id"))},events:{click:"clicked"},select:function(){this.$el.addClass("active")},unSelect:function(){this.$el.removeClass("active")},clicked:function(e){e.preventDefault(),t.execute(t.SHOW_MODULE,this.model.get("id"))}}),e.views.SidebarOptions=t.Views.CompositeView.extend({template:"sidebar/list/listContainer",itemView:e.views.SideBarTab,itemViewContainer:"#main-nav",unSelectAll:function(){this.children.each(function(e){e.unSelect()})},selectTabView:function(e){this.unSelectAll();var t=this.children.find(function(t){return t.model.get("id")==e});t.select()}})})}),define("modules/sidebar/list/list_controller",["modules/sidebar/list/list_view"],function(){Application.module("Sidebar.List",function(e,t,n,r,i,s){e.Controller=t.Controllers.Base.extend({initialize:function(){this.sidebarView=this.getLayout(),this.show(this.sidebarView)},getLayout:function(){var n;t.request(t.GET_ROLE)==t.COUNSELOR_ROLE?n=this.getCounselorSideBarOptionCollection():n=this.getStudentSideBarOptionCollection();var r=new e.views.SidebarOptions({collection:n});return r},activateSidebarTab:function(e){this.sidebarView.selectTabView(e)},getCounselorSideBarOptionCollection:function(){return new t.Entities.Collection([new t.Entities.Model({id:t.CAREER_SHOW,name:"Home",icon:"icon-home"}),new t.Entities.Model({id:t.SETTINGS_SHOW,name:"Settings",icon:"icon-cog"}),new t.Entities.Model({id:t.FORUM_SHOW,name:"Forum",icon:"icon-globe"})])},getStudentSideBarOptionCollection:function(){return new t.Entities.Collection([new t.Entities.Model({id:t.CAREER_SHOW,name:"Home",icon:"icon-home"}),new t.Entities.Model({id:t.SETTINGS_SHOW,name:"Settings",icon:"icon-cog"}),new t.Entities.Model({id:t.FORUM_SHOW,name:"Forum",icon:"icon-globe"})])}})})}),define("modules/sidebar/sidebar_app",["modules/sidebar/list/list_controller"],function(){Application.module("Sidebar",function(e,t,n,r,i,s){var o={list:function(){e.controller||(e.controller=new e.List.Controller({region:t.sidebarRegion}))},setSidebar:function(t){e.controller.activateSidebarTab(t)}};e.setup=function(){o.list()},e.on(t.START,function(){console.log("Sidebar start..."),r.TemplateLoader.loadModuleTemplates(e.List,e.setup)}),t.commands.setHandler(t.SET_SIDEBAR,function(e){o.setSidebar(e)})})}),define("modules/profile/profile_setup",[],function(){Application.module("Profile",function(e,t,n,r,i,s){this.prefix="Profile",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/profile/profile_view",["modules/profile/profile_setup"],function(){Application.module("Profile",function(e,t,n,r,i,s){e.views.StudentProfileLayout=t.Views.Layout.extend({template:"profile/student/student_layout",regions:{institutionRegion:"#institution",careerRegion:"#career",academicRegion:"#academic",personalRegion:"#personal"}}),e.views.InstitutionalView=t.Views.ItemView.extend({template:"profile/student/institutional_view",onRender:function(){n.Validation.bind(this),this.setupInstitutionView()},setupInstitutionView:function(){e.setupSelect2EditableBox(this.$el,this.model,"schoolId",this.options.allSchoolsMap,"Enter School name",this.model.get("school")),e.setupSelect2EditableBox(this.$el,this.model,"ownerId",this.options.allCounselorsMap,"Enter Counselor Name",this.model.get("ownerId"))}}),e.views.CareerView=t.Views.ItemView.extend({template:"profile/student/career_view",onRender:function(){n.Validation.bind(this),this.setupCareerView()},setupCareerView:function(){var t=[{id:"uk",text:"United Kingdom"},{id:"cn",text:"Canada"},{id:"au",text:"Australia"},{id:"nz",text:"New Zealand"},{id:"us",text:"United States"},{id:"in",text:"India"},{id:"ru",text:"Russia"}];e.setupSelect2EditableBox(this.$el,this.model,"countryInterested",t,"Select Country",this.model.get("countryInterested")),e.setupSelect2EditableBox(this.$el,this.model,"fieldInterested",this.options.allStreamsMap,"Select Field",this.model.get("fieldInterested")),e.setupSelect2EditableBox(this.$el,this.model,"programInterested",this.options.allOccupationsMap,"Select Program",this.model.get("programInterested"))}}),e.views.AcademicView=t.Views.ItemView.extend({template:"profile/student/academic_view",onRender:function(){n.Validation.bind(this),this.setupAcademicView()},setupEditableBox:function(e,t,n,r){var i=this;this.$el.find("#"+e).editable({type:r,emptytext:t,value:n,success:function(t,n){i.model.save(e,n,{wait:!0,patch:!0,success:function(e){console.log("Saved on server!!")},error:function(e,t){return console.log("Error on server!! -- "+t),t}})}})},setupAcademicView:function(){this.setupEditableBox("highSchoolScore","Enter Xth score/grade",this.model.get("highSchoolScore"),"text"),this.setupEditableBox("seniorSecondaryScore","Enter XIIth score/grade",this.model.get("seniorSecondaryScore"),"text"),this.setupEditableBox("gre","Enter GRE score/grade",this.model.get("gre"),"text"),this.setupEditableBox("gmat","Enter GMAT score/grade",this.model.get("gmat"),"text"),this.setupEditableBox("sat","Enter SAT score/grade",this.model.get("sat"),"text"),this.setupEditableBox("toefl","Enter TOEFL score/grade",this.model.get("toefl"),"text"),this.setupEditableBox("ielts","Enter IELTS score/grade",this.model.get("ielts"),"text"),this.setupEditableBox("remarks","Enter any other details",this.model.get("remarks"),"textarea")}}),e.setupSelect2EditableBox=function(e,t,n,r,i,s){e.find("#"+n).editable({source:r,type:"select2",value:s,emptytext:i,select2:{placeholder:i},success:function(e,r){console.log(r),t.save(n,r,{wait:!0,patch:!0,success:function(e){console.log("Saved on server!!")},error:function(e,t){return console.log("Error on server!! -- "+t),t}})}})}})}),define("modules/entities/school",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.getAllCounselorUrl="/users/counselors",e.allSchoolsUrl="/schools/all",e.schoolUrl="/school",e.School=e.Model.extend({urlRoot:e.schoolUrl}),e.SchoolCollection=e.Collection.extend({model:e.School});var o={getSchool:function(t){if(!t)return new e.School;var n=new e.School;return n.id=t,n.fetch(),n},getAllSchools:function(){return e.allSchools||(e.allSchools=new e.SortedCollection,e.allSchools.url=e.allSchoolsUrl,e.allSchools.fetch()),e.allSchools}};t.reqres.setHandler(t.SCHOOLS_GET,function(){return o.getAllSchools()}),t.reqres.setHandler(t.SCHOOL_GET,function(e){return o.getSchool(e)})})}),define("modules/profile/profile_controller",["modules/profile/profile_view","modules/entities/user","modules/entities/school"],function(){Application.module("Profile",function(e,t,n,r,i,s){e.Controller=t.Controllers.Base.extend({initialize:function(){var e=t.request(t.GET_LOGGED_USER),n=t.request(t.SCHOOLS_GET),r=t.request(t.COUNSELORS_GET),i=t.request(t.STREAMS_GET),s=t.request(t.OCCUPATIONS_GET);this.layout=this.getLayout(e),this.listenTo(this.layout,t.SHOW,function(){this.populateView(e,n,r,i,s)}),this.show(this.layout,{loading:{entities:[e,n,r,i,s]}})},populateView:function(n,r,i,s,o){if(n.get("roleType")===t.STUDENT_ROLE||n.get("roleType")===t.ADMIN_ROLE){var u=new e.views.InstitutionalView({model:n,allSchoolsMap:r.getIdToTitleArrayMap(),allCounselorsMap:i.getIdToTextMap("fullName")});this.layout.institutionRegion.show(u);var a=new e.views.CareerView({model:n,allStreamsMap:s.getIdToTitleArrayMap(),allOccupationsMap:o.getIdToTitleArrayMap()});this.layout.careerRegion.show(a);var f=new e.views.AcademicView({model:n});this.layout.academicRegion.show(f)}},getLayout:function(n){if(n.get("roleType")===t.STUDENT_ROLE||n.get("roleType")===t.ADMIN_ROLE)return new e.views.StudentProfileLayout}})})}),define("modules/loading/loading_view",["modules/main/main_app"],function(){Application.module("Loading",function(e,t,n,r,i,s){e.View=r.ItemView.extend({template:function(e){return s.template("")},className:"loading-container",onShow:function(){var e=this.getOptions();this.$el.spin(e)},onClose:function(){this.$el.spin(!1)},getOptions:function(){return{lines:10,length:6,width:2.5,radius:7,corners:1,rotate:9,direction:1,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!0,className:"spinner",zIndex:2e9,top:"auto",left:"auto"}}})})}),define("modules/loading/loading_controller",["modules/loading/loading_view"],function(){Application.module("Loading",function(e,t,n,r,i,s){e.TYPE_SPINNER="spinner",e.TYPE_OPACITY="opacity",e.Controller=t.Controllers.Base.extend({initialize:function(t){this.view=t.view,this.config=t.config,s.isBoolean(this.config)&&(this.config={}),s.defaults(this.config,{loadingType:e.TYPE_SPINNER,entities:this.getEntities(this.view),debug:!1});switch(this.config.loadingType){case e.TYPE_OPACITY:this.region.currentView.$el.css("opacity",.5);break;case e.TYPE_SPINNER:var n=this.getLoadingView();this.show(n);break;default:throw new Error("Invalid loadingType")}this.showRealView(this.view,n,this.config)},showRealView:function(n,r,i){var s=this;t.execute(t.WHEN_FETCHED,i.entities,function(){switch(i.loadingType){case e.TYPE_OPACITY:s.region.currentView.$el.removeAttr("style");break;case e.TYPE_SPINNER:if(s.region.currentView!==r)return n.close()}i.debug||s.show(n)})},getEntities:function(e){return s.chain(e).pick("model","collection").toArray().compact().value()},getLoadingView:function(){return new e.View}}),t.commands.setHandler(t.SHOW_LOADING,function(t,n){new e.Controller({view:t,region:n.region,config:n.loading})})})}),define("modules/profile/profile_app",["modules/profile/profile_controller","modules/loading/loading_controller"],function(){Application.module("Profile",function(e,t,n,r,i,s){e.rootRoute="profile",e.Router=r.AppRouter.extend({appRoutes:{profile:"show","profile/":"show"}});var o={show:function(){console.log("Show Profile"),new e.Controller({region:t.pageContentRegion}),t.commands.execute(t.SET_SIDEBAR,t.PROFILE_SHOW)}};e.setup=function(){new e.Router({controller:o})},e.on(t.START,function(){console.log("Profile start..."),r.TemplateLoader.loadModuleTemplates(e,e.setup)}),t.commands.setHandler(t.PROFILE_SHOW,function(){o.show(),t.navigate(e.rootRoute)})})}),define("modules/career/career_setup",[],function(){Application.module("Career",function(e,t,n,r,i,s){this.prefix="Career",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/career/career_view",["modules/career/career_setup"],function(){Application.module("Career",function(e,t,n,r,i,s){e.views.Layout=t.Views.Layout.extend({template:"career/career_layout",regions:{navigationTabsRegion:"#nav-tabs",tabContentRegion:"#tab-content"}}),e.views.BasicInfoView=t.Views.ItemView.extend({template:"career/templates/basicInfo",onRender:function(){var t="basicInfoEditor",n="basicInfo";e.setupWYSIWIGEditor(this,t,this.model.get("basicInfo"),"Add info...",n)}});var o="<div class='sectionHeader' id='<%=args.headingId%>'><%=args.headingTitle%><hr></div><div id='<%=args.editorId%>'></div>";e.views.GenericWYSIWYGView=t.Views.ItemView.extend({className:"wysihtml5",template:function(e){return s.template(o,{headingId:e.headingId,headingTitle:e.headingTitle,editorId:e.editorId},{variable:"args"})},serializeData:function(){var e=this.model.toJSON();return e.headingId=this.options.headingId,e.headingTitle=this.options.headingTitle,e.editorId=this.options.editorId,e},onRender:function(){var t=this.model.toJSON();e.setupWYSIWIGEditor(this,this.options.editorId,this.options.value,this.options.emptyText,this.options.modelAttr)}}),e.setupWYSIWIGEditor=function(e,n,r,i,s){e.$el.find("#"+n).editable({type:"wysihtml5",emptytext:i,value:r,disabled:!t.USER_IS_ADMIN,success:function(t,n){e.model.save(s,n,{wait:!0,patch:!0,success:function(e){console.log("Saved on server!!"),console.dir(e)},error:function(e,t){return console.dir(t),console.log("Error on server!! -- "+t),t}})}})}})}),define("modules/career/navigation/nav_setup",[],function(){Application.module("Career.Navigation",function(e,t,n,r,i,s){this.prefix="Career.Navigation",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/career/navigation/nav_view",["modules/career/navigation/nav_setup"],function(){Application.module("Career.Navigation",function(e,t,n,r,i,s){e.views.SelectNavBar=t.Views.Layout.extend({template:"career/navigation/navigation",regions:{streamSelectRegion:"#streamSelect",majorSelectRegion:"#majorSelect",specializationSelectRegion:"#specializationSelect"}});var o='<span id="<%=args.selectSpanId%>"></span>',u='<i class="icon-chevron-right" style="margin-right: 3px;"></i>'+o;e.views.Select=t.Views.ItemView.extend({template:function(e){return e.isStream?s.template(o,{selectSpanId:e.selectSpanId},{variable:"args"}):s.template(u,{selectSpanId:e.selectSpanId},{variable:"args"})},tagName:"span",className:"searchSelect",events:{"click #remove":"removeItem"},removeItem:function(){this.remove(),this.trigger("removed",this.model)},onRender:function(){this.editableTag=this.$el.find("#"+this.model.attributes.selectSpanId);var e=this;this.editableTag.editable({source:e.options.selectOptionsList,emptytext:e.options.emptyText,type:"select2",select2:{placeholder:e.options.emptyText,allowClear:!0},success:function(t,n){e.trigger(e.options.selectEvt,n)}}),this.editableTag.editable("option","disabled",!1)},setValue:function(e){this.editableTag.editable("setValue",e)}})})}),define("modules/career/navigation/nav_controller",["modules/career/navigation/nav_view"],function(){Application.module("Career.Navigation",function(e,t,n,r,i,s){e.Controller=t.Controllers.Base.extend({initialize:function(e){var n=e.collection;this.layout=this.getNavLayout(),this.listenTo(this.layout,t.SHOW,function(){this.showStreamSelect(n)}),this.show(this.layout)},showStreamSelect:function(n){var r=this,i=new e.views.Select({model:new t.Entities.Model({selectSpanId:"streamSelect",isStream:!0}),selectOptionsList:n.getIdToTitleArrayMap(),emptyText:"Select Stream...",selectEvt:t.STREAM_SELECT});r.layout.streamSelectRegion.show(i),r.listenTo(i,t.STREAM_SELECT,function(e){t.commands.execute(t.STREAM_SELECT,e)})},getNavLayout:function(){return new e.views.SelectNavBar}})})}),define("modules/career/navigation/nav_app",["modules/career/navigation/nav_controller"],function(){Application.module("Career.Navigation",function(e,t,n,r,i,s){var o={list:function(t,n){console.log("Start Nav.."),new e.Controller({region:t,collection:n})}};t.commands.setHandler(t.CAREER_NAV_SHOW,function(e,t){o.list(e,t)})})}),define("modules/career/home/home_setup",[],function(){Application.module("Career.Home",function(e,t,n,r,i,s){this.prefix="Career.Home",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/career/home/home_view",["modules/career/home/home_setup"],function(){Application.module("Career.Home",function(e,t,n,r,i,s){e.views.Layout=t.Views.Layout.extend({template:"career/home/home_layout",regions:{streamLinksRegion:"#streamlinks",streamContentRegion:"#streamContent",adminRegion:"#adminSection"}});var o="<%=args.linkText%>";e.views.StreamLink=t.Views.ItemView.extend({template:function(e){return s.template(o,{linkText:e.title},{variable:"args"})},tagName:"span",initialize:function(e){this.$el.prop("class","span3 streamlink "+e.colorClass)},events:{click:"clicked"},clicked:function(e){e.preventDefault(),this.trigger(t.STREAM_LINK_SELECT,this)}});var u=["biology","commerce","engineering","arts"];e.views.StreamLinkComposite=t.Views.CompositeView.extend({template:function(){return s.template("")},itemView:e.views.StreamLink,className:"row-fluid streamLinkComposite",itemViewOptions:function(e,t){return{colorClass:u[t]}},initialize:function(){var e=this;this.on(t.CHILDVIEW+":"+t.STREAM_LINK_SELECT,function(n){e.trigger(t.STREAM_LINK_SELECT,n.model.get("id"))})}}),e.views.PageContent=t.Views.ItemView.extend({template:"career/home/landing_page",tagName:"span"}),e.views.AddNewStream=t.Views.ItemView.extend({template:"career/home/add_stream",events:{"click #createStream":t.STREAM_CREATE},onRender:function(){n.Validation.bind(this)},createStream:function(e){e.preventDefault(),this.trigger(t.STREAM_CREATE,this)}})})}),define("modules/career/major/major_setup",[],function(){Application.module("Career.Major",function(e,t,n,r,i,s){this.prefix="Career.Major",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/career/major/major_view",["modules/career/major/major_setup"],function(){Application.module("Career.Major",function(e,t,n,r,i,s){console.log("Major view reached..."),e.views.Layout=t.Views.Layout.extend({template:"career/major/major_layout",regions:{specializationCompositeRegion:"#specializationComposite",basicInfoRegion:"#basicInfo",schoolPrepRegion:"#schoolPrep",collegeAdmissionRegion:"#collegeAdmission",specializationRegion:"#specializations",careerConnectRegion:"#careerConnect",occupationsRegion:"#occupations",salaryRegion:"#salary",collegeUnivRegion:"#collegeUniv",newOccupationRegion:"#newOccupation",newCollegeRegion:"#newCollege",addSpecializationRegion:"#addSpecialization"}});var o="<%=args.title%>";e.views.Specialization=t.Views.ItemView.extend({template:function(e){return s.template(o,{title:e.title},{variable:"args"})},tagName:"li"}),e.views.SpecializationComposite=t.Views.CompositeView.extend({itemView:e.views.Specialization,template:"career/major/templates/specializationView",itemViewContainer:"ul"});var u="<%=args.title%>";e.views.Occupation=t.Views.ItemView.extend({template:function(e){return s.template(u,{title:e.title},{variable:"args"})},tagName:"li"}),e.views.OccupationComposite=t.Views.CompositeView.extend({template:"career/major/templates/occupationsView",itemView:e.views.Occupation,itemViewContainer:"ul",onRender:function(){if(t.USER_IS_ADMIN){var n=this,r="Add Occupation - (Create new below if needed)";this.$el.find("#addOccupation").editable({source:n.options.selectOptionsList,emptytext:r,type:"select2",disabled:!t.USER_IS_ADMIN,select2:{placeholder:r,allowClear:!0},success:function(t,r){n.trigger(e.addOccupationEvt,r)}})}}});var a="<%=args.title%> - <a href='<%=args.website%>' target='_blank'><%=args.website%></a>";e.views.College=r.ItemView.extend({template:function(e){return s.template(a,{title:e.title,website:e.website},{variable:"args"})},tagName:"li"}),e.views.CollegeComposite=r.CompositeView.extend({template:"career/major/templates/collegesView",itemView:e.views.College,itemViewContainer:"ul",onRender:function(){if(t.USER_IS_ADMIN){var n=this,r="Add College - (Create new below if needed)";this.$el.find("#addCollege").editable({source:n.options.selectOptionsList,emptytext:r,type:"select2",disabled:!t.USER_IS_ADMIN,select2:{placeholder:r,allowClear:!0},success:function(t,r){n.trigger(e.addCollegeEvt,r)}})}}}),e.views.AddSpecialization=t.Views.ItemView.extend({template:"career/major/templates/addSpecialization",className:"well",events:{"click #addSpecialization":"addSpecialization"},onRender:function(){n.Validation.bind(this)},addSpecialization:function(t){t.preventDefault(),this.trigger(e.addSpecializationEvt,this)}}),e.views.AddNewOccupation=t.Views.ItemView.extend({template:"career/major/templates/newOccupationView",events:{"click #createOccupation":"createOccupation"},onRender:function(){n.Validation.bind(this)},createOccupation:function(t){t.preventDefault(),this.trigger(e.createOccupationEvt,this)}}),e.views.AddNewCollege=r.ItemView.extend({template:"career/major/templates/newCollegeView",events:{"click #createCollege":"createCollege"},onRender:function(){n.Validation.bind(this)},createCollege:function(t){t.preventDefault(),this.trigger(e.createCollegeEvt,this)}})})}),define("modules/career/major/major_controller",["modules/career/major/major_view"],function(){Application.module("Career.Major",function(e,t,n,r,i,s){e.addSpecializationEvt="addSpecialization",e.addOccupationEvt="addOccupation",e.addCollegeEvt="addCollege",e.createOccupationEvt="createOccupation",e.createCollegeEvt="createCollege",e.Controller=t.Controllers.Base.extend({initialize:function(e){var n=t.request(t.MAJOR_GET,e.majorId),r=t.request(t.OCCUPATIONS_GET),i=t.request(t.COLLEGES_GET);this.layout=this.getLayout(),this.listenTo(this.layout,t.SHOW,function(){this.showBasicInfo(n),this.showSchoolPrep(n),this.showCollegeAdmission(n),this.showSpecialization(n),this.showCareerConnect(n),this.showSalarySection(n),this.showOccupationsSection(n,r),this.showCollegesSection(n,i),t.USER_IS_ADMIN&&this.showAdminSection(n)}),this.show(this.layout,{loading:{entities:[n,r,i]}})},showAdminSection:function(e){this.showAddSpecializationSection(e),this.showCreateNewOccupationSection(e),this.showCreateNewCollegeSection(e)},showCreateNewCollegeSection:function(r){var s=this,o=new e.views.AddNewCollege({model:t.request(t.COLLEGE_GET)});this.layout.newCollegeRegion.show(o),this.listenTo(o,e.createCollegeEvt,function(e){var o=n.Syphon.serialize(e);e.model.save(o,{wait:!0,success:function(e){var n=t.request(t.COLLEGES_GET,!0);t.execute(t.WHEN_FETCHED,n,function(){s.showCollegesSection(r,n)}),i.jGrowl("New college created: "+e.get("title"),{theme:"jGrowlSuccess"}),s.showCreateNewCollegeSection(r)},error:function(e,t){i.jGrowl("Error saving college: "+o.title,{theme:"jGrowlError"}),console.error("Error Model: "+e.toJSON()),console.error("Error Response: "+t.statusText),s.showCreateNewCollegeSection(r)}})})},showCreateNewOccupationSection:function(r){var s=t.request(t.OCCUPATION_GET),o=new e.views.AddNewOccupation({model:s});this.layout.newOccupationRegion.show(o),this.listenTo(o,e.createOccupationEvt,function(e){var s=this,o=n.Syphon.serialize(e);e.model.unset("urlRoot",{silent:!0}),e.model.save(o,{wait:!0,success:function(e){var n=t.request(t.OCCUPATIONS_GET,!0);t.execute(t.WHEN_FETCHED,n,function(){s.showOccupationsSection(r,n)}),i.jGrowl("New occupation created: "+e.get("title"),{theme:"jGrowlSuccess"}),s.showCreateNewOccupationSection(r)},error:function(e,t){i.jGrowl("Error saving "+e.get("title"),{theme:"jGrowlError"}),console.error("Error Model: "+e.toJSON()),console.error("Error Response: "+t.statusText),s.showCreateNewOccupationSection(r)}})})},showAddSpecializationSection:function(t){var r=this,s=new e.views.AddSpecialization({model:t});this.layout.addSpecializationRegion.show(s),this.listenTo(s,e.addSpecializationEvt,function(e){var s=n.Syphon.serialize(e);e.model.save(s,{wait:!0,patch:!0,success:function(e){i.jGrowl("New Specialization created: "+e.get("title"),{theme:"jGrowlSuccess"}),r.showSpecialization(t),r.showAddSpecializationSection(t)},error:function(e,n){i.jGrowl("Error saving "+e.get("title"),{theme:"jGrowlError"}),console.error("Error Model: "+e.toJSON()),console.error("Error Response: "+n.statusText),r.showAddSpecializationSection(t)}})})},showCollegesSection:function(n,r){var i=this,s=new e.views.CollegeComposite({model:n,collection:new t.Entities.SortedCollection(n.get("colleges")),selectOptionsList:r.getIdToTitleArrayMap()});this.layout.collegeUnivRegion.show(s),this.listenTo(s,e.addCollegeEvt,function(e){n.save("addCollege",e,{wait:!0,patch:!0,success:function(e){i.showCollegesSection(e,r)},error:function(e,t){console.log("Error on server!! -- "+t),i.showCollegesSection(n,r)}})})},showOccupationsSection:function(n,r){var i=this,s=new e.views.OccupationComposite({model:n,collection:new t.Entities.SortedCollection(n.get("occupations")),selectOptionsList:r.getIdToTitleArrayMap()});this.layout.occupationsRegion.show(s),this.listenTo(s,e.addOccupationEvt,function(e){n.save("addOccupation",e,{wait:!0,patch:!0,success:function(e){i.showOccupationsSection(e,r)},error:function(e,t){console.log("Error on server!! -- "+t),i.showOccupationsSection(n,r)}})})},showSalarySection:function(t){var n=new e.parent.views.GenericWYSIWYGView({model:t,headingId:"salary_heading",headingTitle:"Salary",editorId:"salaryEditor",modelAttr:"salary",emptyText:"Add salary info...",value:t.get("salary")});this.layout.salaryRegion.show(n)},showCareerConnect:function(t){var n=new e.parent.views.GenericWYSIWYGView({model:t,headingId:"careerConnect_heading",headingTitle:"Career Connect",editorId:"careerConnectEditor",modelAttr:"careerConnect",emptyText:"Add Career Connect info...",value:t.get("careerConnect")});this.layout.careerConnectRegion.show(n)},showSpecialization:function(n){var r=new e.views.SpecializationComposite({model:n,collection:new t.Entities.SortedCollection(n.get("specializations"))});this.layout.specializationRegion.show(r)},showCollegeAdmission:function(t){var n=new e.parent.views.GenericWYSIWYGView({model:t,headingId:"collegeAdmission_heading",headingTitle:"College Admission",editorId:"collegeAdmissionEditor",modelAttr:"admission",emptyText:"Add College Admission info...",value:t.get("admission")});this.layout.collegeAdmissionRegion.show(n)},showSchoolPrep:function(t){var n=new e.parent.views.GenericWYSIWYGView({model:t,headingId:"schoolPrep_heading",headingTitle:"School Prep",editorId:"schoolPrepEditor",modelAttr:"schoolPrep",emptyText:"Add School Prep info...",value:t.get("schoolPrep")});this.layout.schoolPrepRegion.show(n)},showBasicInfo:function(t){var n=new e.parent.views.BasicInfoView({model:t});this.layout.basicInfoRegion.show(n)},getLayout:function(){return new e.views.Layout}})})}),define("modules/career/major/major_app",["modules/career/major/major_controller"],function(){Application.module("Career.Major",function(e,t,n,r,i,s){var o={list:function(t,n){new e.Controller({region:t,majorId:n})}};t.commands.setHandler(t.MAJOR_SHOW,function(n,r,i){o.list(n,i),t.navigate(e.parent.rootRoute+"/"+r+"/"+i)})})}),define("modules/career/stream/stream_setup",[],function(){Application.module("Career.Stream",function(e,t,n,r,i,s){this.prefix="Career.Stream",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/career/stream/stream_view",["modules/career/stream/stream_setup"],function(){Application.module("Career.Stream",function(e,t,n,r,i,s){e.views.Layout=t.Views.Layout.extend({template:"career/stream/stream_layout",regions:{majorsCompositeRegion:"#majorsComposite",basicInfoRegion:"#basicInfo",skillsRegion:"#skills",degreesRegion:"#degrees",addMajorToStreamRegion:"#addMajorToStream",newDegreeRegion:"#newDegree",newMajorRegion:"#newMajor"}}),e.views.SkillsView=t.Views.ItemView.extend({template:"career/stream/templates/skills",serializeData:function(){return this.data=this.model.toJSON(),this.data.heading_skills="Skills Required",this.data},onRender:function(){var t="skills";e.parent.setupWYSIWIGEditor(this,t,this.model.get("skills"),"Add required skills...",t)}}),e.views.DegreesLayout=r.Layout.extend({template:"career/stream/templates/degreesLayout",regions:{bachelorsRegion:"#bachelors",mastersRegion:"#masters",doctorateRegion:"#doctorate"}}),e.views.Degree=t.Views.ItemView.extend({template:"career/stream/templates/degreeView",serializeData:function(){return this.data=this.model.toJSON(),this.data.degreeSectionHeader=this.options.degreeSectionHeader,this.data.degreeSectionId=this.options.degreeSectionId,this.data},onRender:function(){var n=this,r=this.options.degreeSectionId;this.$el.find("#"+r).editable({type:"checklist",source:n.options.checklistSource,disabled:!t.USER_IS_ADMIN,emptytext:"Add degrees (Create new below...)",value:n.options.value,success:function(t,r){console.log(r.concat(n.options.addOnIdArr)),n.model.save(e.DEGREES,r.concat(n.options.addOnIdArr),{patch:!0,success:function(t){n.trigger(e.updateDegreesEvt,t)},error:function(e,t){return console.dir(t),console.log("Error on server!! -- "+t),t}})}})}});var o="<h3>Admin Section</h3><legend>AddMajorToStream</legend><span id='addMajor'></span>";e.views.AddMajorToStream=t.Views.ItemView.extend({template:function(e){return s.template(o,{},{variable:"args"})},onRender:function(){var e=this;this.$el.find("#addMajor").editable({source:e.options.source,emptytext:"Add Major to stream (Create new below...)",type:"select2",disabled:!t.USER_IS_ADMIN,select2:{placeholder:"Add Major",allowClear:!0},success:function(t,n){console.log(n),e.model.save("major",n,{patch:!0,success:function(e){i.jGrowl("New major added: "+e.get("title"),{theme:"jGrowlSuccess"}),console.log("Saved on server!!")},error:function(e,t){return i.jGrowl("Error saving major!",{theme:"jGrowlError"}),console.dir(t),console.log("Error on server!! -- "+t),t}})}})}}),e.views.AddNewDegree=t.Views.ItemView.extend({template:"career/stream/templates/newDegree",events:{"click #createDegree":"createDegree"},onRender:function(){n.Validation.bind(this)},createDegree:function(t){t.preventDefault(),this.trigger(e.createDegreeEvt,this)}}),e.views.AddNewMajor=t.Views.ItemView.extend({template:"career/stream/templates/newMajor",events:{"click #createMajor":"createMajor"},onRender:function(){n.Validation.bind(this)},createMajor:function(t){t.preventDefault(),this.trigger(e.createMajorEvt,this)}});var u="<a><%=args.linkText%></a>";e.views.MajorLink=t.Views.ItemView.extend({template:function(e){return s.template(u,{linkText:e.title},{variable:"args"})},tagName:"li",events:{click:"clicked"},clicked:function(t){t.preventDefault(),this.trigger(e.selectedLinkEvt,this)}}),e.views.MajorLinkComposite=t.Views.CompositeView.extend({template:"career/stream/templates/majorComposite",itemView:e.views.MajorLink,className:"streamLinkComposite",itemViewContainer:"ul",initialize:function(){var n=this;this.on(t.CHILDVIEW+":"+e.selectedLinkEvt,function(t){n.trigger(e.selectedLinkEvt,t.model.get("id"))})}})})}),define("modules/career/stream/stream_controller",["modules/career/stream/stream_view"],function(){Application.module("Career.Stream",function(e,t,n,r,i,s){e.BACHELORS="bachelors",e.MASTERS="masters",e.DOCTORATE="doctorate",e.DEGREES="degrees",e.createMajorEvt="createMajor",e.createDegreeEvt="createDegree",e.updateDegreesEvt="updateDegreesSection",e.selectedLinkEvt="selectedLink",e.Controller=t.Controllers.Base.extend({initialize:function(e){var n=t.request(t.STREAM_GET,e.streamId),r=t.request(t.MAJORS_GET),i=t.request(t.DEGREES_BACHELORS_GET),s=t.request(t.DEGREES_MASTERS_GET),o=t.request(t.DEGREES_DOCTORATE_GET);this.layout=this.getLayout(),this.listenTo(this.layout,t.SHOW,function(){this.showBasicInfo(n),this.showSkillsSection(n),this.showDegreesSection(n,i,s,o),this.showMajorsSection(n),t.USER_IS_ADMIN&&this.showAdminSection(n,r)}),this.show(this.layout,{loading:{entities:[n,r,i,s,o]}})},showMajorsSection:function(n){var r=this,i=new e.views.MajorLinkComposite({collection:new t.Entities.SortedCollection(n.get("majors")),model:new t.Entities.Model({headingText:"Majors",contentId:"majors"})});this.layout.majorsCompositeRegion.show(i),this.listenTo(i,e.selectedLinkEvt,function(e){t.commands.execute(t.MAJOR_SHOW,r.region,n.get("id"),e)})},showAdminSection:function(e,t){this.addMajorToStream(e,t),this.createNewDegree(e),this.createNewMajor(e)},createNewMajor:function(r){var s=this,o=new t.Entities.Model;o.urlRoot=t.Entities.majorUrl;var u=new e.views.AddNewMajor({model:o});this.layout.newMajorRegion.show(u),this.listenTo(u,e.createMajorEvt,function(e){var t=n.Syphon.serialize(e);console.log(t),e.model.unset("urlRoot",{silent:!0}),e.model.save(t,{wait:!0,success:function(e){i.jGrowl("New degree created: "+e.get("title"),{theme:"jGrowlSuccess"}),s.showAdminSection(r)},error:function(e,t){i.jGrowl("Error saving "+e.get("title")+" degree!",{theme:"jGrowlError"}),console.error("Error Model: "+e.toJSON()),console.error("Error Response: "+t.statusText),s.showAdminSection(r)}})})},createNewDegree:function(r){var s=this,o=new t.Entities.Model;o.urlRoot=t.Entities.degreeUrl;var u=new e.views.AddNewDegree({model:o});this.layout.newDegreeRegion.show(u),this.listenTo(u,e.createDegreeEvt,function(e){var t=n.Syphon.serialize(e);console.log(t),e.model.unset("urlRoot",{silent:!0}),e.model.save(t,{wait:!0,success:function(e){i.jGrowl("New degree created: "+e.get("title"),{theme:"jGrowlSuccess"}),s.showDegreesSection(r),s.showAdminSection(r)},error:function(e,t){i.jGrowl("Error saving "+e.get("title")+" degree!",{theme:"jGrowlError"}),console.error("Error Model: "+e.toJSON()),console.error("Error Response: "+t.statusText),s.showAdminSection(r)}})})},addMajorToStream:function(t,n){var r=this,i=new e.views.AddMajorToStream({model:t,source:n.getIdToTitleArrayMap()});r.layout.addMajorToStreamRegion.show(i)},showBasicInfo:function(t){var n=new e.parent.views.BasicInfoView({model:t});this.layout.basicInfoRegion.show(n)},showSkillsSection:function(t){var n=new e.views.SkillsView({model:t});this.layout.skillsRegion.show(n)},showDegreesSection:function(t,n,r,i){var o=new e.views.DegreesLayout;this.layout.degreesRegion.show(o);var u=s.pluck(s.filter(t.get("degrees"),function(t){return t.type==e.BACHELORS}),"id"),a=s.pluck(s.filter(t.get("degrees"),function(t){return t.type==e.MASTERS}),"id"),f=s.pluck(s.filter(t.get("degrees"),function(t){return t.type==e.DOCTORATE}),"id"),l=this;if(s.size(n.models)>0){var c=l.getDegreeChecklistView(o,t,"Bachelors",e.BACHELORS,n,u,a.concat(f));o.bachelorsRegion.show(c)}if(s.size(r.models)>0){var h=l.getDegreeChecklistView(o,t,"Masters",e.MASTERS,r,a,u.concat(f));o.mastersRegion.show(h)}if(s.size(i.models)>0){var p=l.getDegreeChecklistView(o,t,"Doctorate",e.DOCTORATE,i,f,u.concat(a));o.doctorateRegion.show(p)}},getDegreeChecklistView:function(t,n,r,i,s,o,u){var a=new e.views.Degree({model:n,degreeSectionHeader:r,degreeSectionId:i,checklistSource:s.getValueToTitleArrayMap(),value:o,addOnIdArr:u});return this.listenTo(a,e.updateDegreesEvt,function(e){this.showDegreesSection(e)}),a},getLayout:function(){return new e.views.Layout}})})}),define("modules/career/stream/stream_app",["modules/career/stream/stream_controller"],function(){Application.module("Career.Stream",function(e,t,n,r,i,s){var o={list:function(t,n){new e.Controller({region:t,streamId:n})}};t.commands.setHandler(t.STREAM_SHOW,function(n,r){o.list(n,r),t.navigate(e.parent.rootRoute+"/"+r)})})}),define("modules/career/entities/streams",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.url="/stream",e.all_Url="/streams/all",e.Stream=e.Model.extend({urlRoot:e.url,validation:{title:{required:!0,minLength:4}}}),e.SortedCollection=e.Collection.extend({comparator:function(e){return e.get("title")}}),e.AllStreamsCollection=e.SortedCollection.extend({url:e.all_Url,model:e.Stream});var o={getStreams:function(){return e.allStreams||this.updateDegrees(),e.allStreams},updateDegrees:function(){e.allStreams=new e.AllStreamsCollection,e.allStreams.fetch()},getStream:function(t){if(!t)return new e.Stream;var n=new e.Stream;return n.id=t,n.fetch(),n}};t.reqres.setHandler(t.STREAMS_GET,function(){return o.getStreams()}),t.reqres.setHandler(t.STREAM_GET,function(e){return o.getStream(e)})})}),define("modules/career/entities/colleges",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.collegeUrl="/college",e.allCollegesUrl="/colleges",e.College=e.Model.extend({urlRoot:e.collegeUrl,validation:{title:{required:!0},website:{pattern:"url"}}});var o={getAllColleges:function(t){if(!e.allColleges||t)e.allColleges=new e.SortedCollection,e.allColleges.url=e.allCollegesUrl,e.allColleges.fetch();return e.allColleges},getOccupation:function(t){var n=new e.College;return t?(n.id=t,n.fetch(),n):n}};t.reqres.setHandler(t.COLLEGES_GET,function(e){return o.getAllColleges(e)}),t.reqres.setHandler(t.COLLEGE_GET,function(e){return o.getOccupation(e)})})}),define("modules/career/entities/occupations",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.occupationUrl="/occupation",e.allOccupationsUrl="/occupations",e.Occupation=e.Model.extend({urlRoot:e.occupationUrl,validation:{title:{required:!0}}});var o={getAllOccupations:function(t){if(!e.allOccupations||t)e.allOccupations=new e.SortedCollection,e.allOccupations.url=e.allOccupationsUrl,e.allOccupations.fetch();return e.allOccupations},getOccupation:function(t){var n=new e.Occupation;return t?(n.id=t,n.fetch(),n):n}};t.reqres.setHandler(t.OCCUPATIONS_GET,function(e){return o.getAllOccupations(e)}),t.reqres.setHandler(t.OCCUPATION_GET,function(e){return o.getOccupation(e)})})}),define("modules/career/entities/degrees",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.degreeUrl="/degree",e.allDegreesUrl="/degrees",e.allBachelorsUrl="/degrees/bachelors",e.allMastersUrl="/degrees/masters",e.allDoctorateUrl="/degrees/doctorate";var o={getAllDegrees:function(){return e.allDegrees||this.updateAllDegrees(),e.allDegrees},updateAllDegrees:function(){e.allDegrees=new e.Collection,e.allDegrees.url=e.allDegreesUrl,e.allDegrees.fetch()},getAllBachelorsDegree:function(){return e.allBachelorsDegreeCollection||(e.allBachelorsDegreeCollection=new e.Collection,e.allBachelorsDegreeCollection.url=e.allBachelorsUrl,e.allBachelorsDegreeCollection.fetch()),e.allBachelorsDegreeCollection},getAllMastersDegree:function(){return e.allMastersDegreeCollection||(e.allMastersDegreeCollection=new e.Collection,e.allMastersDegreeCollection.url=e.allMastersUrl,e.allMastersDegreeCollection.fetch()),e.allMastersDegreeCollection},getAllDoctorateDegree:function(){return e.allDoctorateDegreeCollection||(e.allDoctorateDegreeCollection=new e.Collection,e.allDoctorateDegreeCollection.url=e.allDoctorateUrl,e.allDoctorateDegreeCollection.fetch()),e.allDoctorateDegreeCollection}};t.reqres.setHandler(t.DEGREES_BACHELORS_GET,function(){return o.getAllBachelorsDegree()}),t.reqres.setHandler(t.DEGREES_MASTERS_GET,function(){return o.getAllMastersDegree()}),t.reqres.setHandler(t.DEGREES_DOCTORATE_GET,function(){return o.getAllDoctorateDegree()})})}),define("modules/career/entities/majors",[],function(){Application.module("Entities",function(e,t,n,r,i,s){e.majorUrl="/major",e.allMajorsUrl="/majors";var o={getAllMajors:function(){return e.allMajors||(e.allMajors=new e.SortedCollection,e.allMajors.url=e.allMajorsUrl,e.allMajors.fetch()),e.allMajors},getMajor:function(t){var n=new e.Model;return n.urlRoot=e.majorUrl,n.id=t,n.fetch(),n}};t.reqres.setHandler(t.MAJORS_GET,function(){return o.getAllMajors()}),t.reqres.setHandler(t.MAJOR_GET,function(e){return o.getMajor(e)})})}),define("modules/career/home/home_controller",["modules/career/home/home_view","modules/career/major/major_app","modules/career/stream/stream_app","modules/career/entities/streams","modules/career/entities/colleges","modules/career/entities/occupations","modules/career/entities/degrees","modules/career/entities/majors"],function(){Application.module("Career.Home",function(e,t,n,r,i,s){e.Controller=t.Controllers.Base.extend({initialize:function(e){var n=t.request(t.STREAMS_GET);this.layout=this.getLayout(),this.listenTo(this.layout,t.SHOW,function(){this.showStreamLinks(n),this.showPageContent(),t.USER_IS_ADMIN&&this.showAdminSection()}),this.show(this.layout,{loading:{entities:n}})},showAdminSection:function(){var r=new e.views.AddNewStream({model:new t.Entities.Stream});this.listenTo(r,t.STREAM_CREATE,function(e){var r=n.Syphon.serialize(e);e.model.save(r,{wait:!0,success:function(e){i.jGrowl("New stream created: "+e.get("title"),{theme:"jGrowlSuccess"}),t.commands.execute(t.CAREER_SHOW)},error:function(e,n){i.jGrowl("Error saving "+e.get("title")+" stream!",{theme:"jGrowlError"}),console.error("Error Model: "+e),console.error("Error Response: "+n.responseText),t.commands.execute(t.CAREER_SHOW)}})}),this.show(r,{region:this.layout.adminRegion})},showPageContent:function(){var t=new e.views.PageContent;this.show(t,{region:this.layout.streamContentRegion})},showStreamLinks:function(n){var r=this,i=new e.views.StreamLinkComposite({collection:n});this.listenTo(i,t.STREAM_LINK_SELECT,function(e){t.commands.execute(t.STREAM_SHOW,r.region,e)}),this.show(i,{region:this.layout.streamLinksRegion})},getLayout:function(){return new e.views.Layout}})})}),define("modules/career/home/home_app",["modules/career/home/home_controller"],function(){Application.module("Career.Home",function(e,t,n,r,i,s){var o={list:function(t){new e.Controller({region:t})}};t.commands.setHandler(t.CAREER_CONTENT_SHOW,function(e){o.list(e)})})}),define("modules/career/career_controller",["modules/career/career_view","modules/career/navigation/nav_app","modules/career/home/home_app"],function(){Application.module("Career",function(e,t,n,r,i,s){e.Controller=t.Controllers.Base.extend({initialize:function(){this.layout=this.getLayout(),this.listenTo(this.layout,"show",function(){this.showHomeContent()}),this.show(this.layout)},showHomeContent:function(){t.execute(t.CAREER_CONTENT_SHOW,this.layout.tabContentRegion)},getLayout:function(){return new e.views.Layout}})})}),define("modules/career/career_app",["modules/career/career_controller","modules/loading/loading_controller"],function(){Application.module("Career",function(e,t,n,r,i,s){e.rootRoute="career",e.Router=r.AppRouter.extend({appRoutes:{career:"show","career/":"show","career/:streamId":"showStream","career/:streamId/":"showStream","career/:streamId/:majorId/":"showMajor","career/:streamId/:majorId":"showMajor"}});var o={getController:function(){return new e.Controller({region:t.pageContentRegion})},show:function(){console.log("Show Career"),this.getController().showHomeContent(),t.commands.execute(t.SET_SIDEBAR,t.CAREER_SHOW)},showStream:function(e){var n=this.getController().layout.tabContentRegion;t.commands.execute(t.SET_SIDEBAR,t.CAREER_SHOW),t.commands.execute(t.STREAM_SHOW,n,e)},showMajor:function(e,n){var r=this.getController().layout.tabContentRegion;t.commands.execute(t.SET_SIDEBAR,t.CAREER_SHOW),t.commands.execute(t.MAJOR_SHOW,r,e,n)}};e.setup=function(){new e.Router({controller:o}),t.commands.execute(t.MODULES_LOADED,e.rootRoute)},e.on(t.START,function(){console.log("Career start..."),r.TemplateLoader.loadModuleTemplates(e.Stream,function(){r.TemplateLoader.loadModuleTemplates(e.Major,function(){r.TemplateLoader.loadModuleTemplates(e.Home,function(){r.TemplateLoader.loadModuleTemplates(e,e.setup)})})})}),t.commands.setHandler(t.CAREER_SHOW,function(){o.show(),t.navigate(e.rootRoute)})})}),define("modules/settings/settings_setup",[],function(){Application.module("Settings",function(e,t,n,r,i,s){this.prefix="Settings",this.templatePath="assets/javascripts/modules/",this.views={},this.template=function(e){return this.prefix+"-"+e},this.models={},this.collections={}})}),define("modules/settings/settings_view",["modules/settings/settings_setup"],function(){Application.module("Settings",function(e,t,n,r,i,s){e.views.Layout=t.Views.Layout.extend({template:"settings/templates/settings_layout",regions:{profileRegion:"#profileSection",changePasswordRegion:"#changePasswordSection",adminRegion:"#adminSection"}}),e.views.UserInfo=t.Views.ItemView.extend({template:"settings/templates/userInfo"}),e.views.ChangePassword=t.Views.ItemView.extend({template:"settings/templates/change_password",events:{"click #changePassword":"changePassword","click #cancelBtn":"toggleChangePassword","click #changePasswordBtn":"toggleChangePassword"},onRender:function(){n.Validation.bind(this)},changePassword:function(t){t.preventDefault();var r=n.Syphon.serialize(this);this.model.set(r),console.log(this.model.isValid(!0));if(!this.model.isValid(!0))return;this.trigger(e.changePasswordEvt,this),this.toggleChangePassword(t)},toggleChangePassword:function(e){e.preventDefault(),this.$el.find("#changePasswordContainer").fadeToggle()}}),e.views.CreateAdmin=t.Views.ItemView.extend({template:"settings/templates/create_admin",events:{"click #createAdmin":"createAdmin"},onRender:function(){n.Validation.bind(this)},createAdmin:function(t){t.preventDefault(),this.trigger(e.createAdminEvt,this)}})})}),define("modules/settings/settings_controller",["modules/settings/settings_view","modules/entities/user"],function(){Application.module("Settings",function(e,t,n,r,i,s){e.changePasswordEvt="changePassword",e.createAdminEvt="createAdmin",e.Controller=t.Controllers.Base.extend({initialize:function(){var e=t.request(t.GET_LOGGED_USER);this.layout=this.getLayout(),this.listenTo(this.layout,t.SHOW,function(){this.showUserInfoSection(e),this.showChangePasswordSection(e),t.USER_IS_ADMIN&&this.showAdminSection(e)}),this.show(this.layout,{loading:{entities:e}})},showAdminSection:function(r){var s=new e.views.CreateAdmin({model:t.request(t.GET_USER)});this.layout.adminRegion.show(s),this.listenTo(s,e.createAdminEvt,function(e){var r=n.Syphon.serialize(e);r.roleType=t.ADMIN_ROLE,e.model.save(r,{wait:!0,success:function(e){console.log("Got success!!!"),i.jGrowl("New Admin created: "+e.get("firstName"),{theme:"jGrowlSuccess"})},error:function(e,t){i.jGrowl("Error saving "+e.get("firstName"),{theme:"jGrowlError"}),console.error("Error Model: "+e.toJSON()),console.error("Error Response: "+t.statusText)}})})},showUserInfoSection:function(t){var n=new e.views.UserInfo({model:t});this.layout.profileRegion.show(n)},showChangePasswordSection:function(r){var s=new e.views.ChangePassword({model:t.request(t.GET_PASSWORD)});this.layout.changePasswordRegion.show(s),this.listenTo(s,e.changePasswordEvt,function(e){var t=n.Syphon.serialize(e);console.log(t),r.save(t,{wait:!0,patch:!0,success:function(e){i.jGrowl("Password Changed!!!",{theme:"jGrowlSuccess"})},error:function(e,t){i.jGrowl("Error changing password",{theme:"jGrowlError"}),console.error("Error Model: "+e.toJSON()),console.error("Error Response: "+t.statusText)}})})},getLayout:function(){return new e.views.Layout}})})}),define("modules/settings/settings_app",["modules/settings/settings_controller"],function(){Application.module("Settings",function(e,t,n,r,i,s){e.rootRoute="settings",e.Router=r.AppRouter.extend({appRoutes:{settings:"show","settings/":"show"}});var o={show:function(){console.log("Show Settings"),new e.Controller({region:t.pageContentRegion}),t.commands.execute(t.SET_SIDEBAR,t.SETTINGS_SHOW)}};e.setup=function(){new e.Router({controller:o})},e.on(t.START,function(){console.log("Settings start..."),r.TemplateLoader.loadModuleTemplates(e,e.setup)}),t.commands.setHandler(t.SETTINGS_SHOW,function(){o.show(),t.navigate(e.rootRoute)})})}),requirejs.config({paths:{jquery:"lib/jquery/jquery.min",jqueryUI:"lib/jquery-ui/jquery-ui.min",jGrowl:"lib/jquery-jgrowl/jquery.jgrowl.min",underscore:"lib/underscore/underscore-min",backbone:"lib/backbone/backbone-min",marionette:"lib/marionette/backbone.marionette.min",backboneValidation:"lib/backbone-validation/backbone-validation-amd-min",backboneSyphon:"lib/backbone-syphon/backbone.syphon.min",marionette_config_application:"config/marionette/application",marionette_config_module:"config/marionette/module",backbone_config_sync:"config/backbone/sync",templateLoader:"config/app/templateLoader/templateLoader",spin:"lib/spin/spin",jquerySpin:"lib/spin/jquery.spin",moment:"lib/utils/moment.min",dateTimePicker:"lib/utils/bootstrap-datetimepicker.min",dataTables:"lib/jquery-dataTables/jquery.dataTables.min",bootstrapEditable:"lib/bootstrap-editable/bootstrap-editable.min",wysihtml5:"lib/bootstrap-editable/wysihtml5/wysihtml5",wysihtml5_0_3_0:"lib/bootstrap-editable/wysihtml5/bootstrap-wysihtml5-0.0.2/wysihtml5-0.3.0.min",bootstrapWysihtml:"lib/bootstrap-editable/wysihtml5/bootstrap-wysihtml5-0.0.2/bootstrap-wysihtml5-0.0.2.min",select2:"lib/select2/select2",bootstrap:"lib/bootstrap/bootstrap"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},marionette:{deps:["backbone"],exports:"Marionette"},marionette_config_application:{deps:["marionette"]},marionette_config_module:{deps:["marionette"]},backbone_config_sync:{deps:["backbone"]},templateLoader:{deps:["marionette"]},jquerySpin:{deps:["jquery","spin"]},dateTimePicker:{deps:["jquery"]},dataTables:{deps:["jquery"]},jGrowl:{deps:["jquery"]},jqueryUI:{deps:["jquery"]},bootstrap:{deps:["jquery"]},bootstrapEditable:{deps:["bootstrap","select2","bootstrapWysihtml"]},wysihtml5:{deps:["bootstrapEditable"]},wysihtml5_0_3_0:{deps:["jquery"]},bootstrapWysihtml:{deps:["wysihtml5_0_3_0"]},select2:{deps:["jquery"]}}});var dependencies=["marionette","moment","jquery","jqueryUI","jGrowl","backboneValidation","backboneSyphon","bootstrapEditable","wysihtml5","bootstrap","select2","dataTables","dateTimePicker","marionette_config_application","marionette_config_module","backbone_config_sync","templateLoader","jquerySpin"];require(dependencies,function(e){return console.log("Init Application..."),window.Application=new e.Application,Application.MODULES_LOADED="modules:loaded",Application.UNREGISTER_INSTANCE="unregister:instance",Application.REGISTER_INSTANCE="register:instance",Application.DEFAULT_REGION="default:region",Application.rootRoute="career",Application.addRegions({headerRegion:"#header-region",sidebarRegion:"#sidebar-region",pageContentRegion:"#page-content-region",footerRegion:"#footer-region"}),Application.reqres.setHandler(Application.DEFAULT_REGION,function(){return Application.pageContentRegion}),Application.commands.setHandler(Application.REGISTER_INSTANCE,function(e,t){Application.register(e,t)}),Application.commands.setHandler(Application.UNREGISTER_INSTANCE,function(e,t){Application.unregister(e,t)}),Application.addInitializer(function(){Application.module("Header").start(),Application.module("Footer").start(),Application.module("Sidebar").start(),Application.module("Profile").start(),Application.module("Career").start()}),require(["modules/main/main_app"],function(){console.log("Setup...")}),require(["modules/header/header_app","modules/footer/footer_app","modules/sidebar/sidebar_app","modules/profile/profile_app","modules/career/career_app","modules/settings/settings_app"],function(){console.log("Start Application..."),Application.start()}),Application}),define("profiler_app",function(){});